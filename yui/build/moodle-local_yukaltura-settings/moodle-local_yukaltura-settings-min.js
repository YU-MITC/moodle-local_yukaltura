YUI.add("moodle-local_yukaltura-settings",function(e,t){M.local_yukaltura=M.local_yukaltura||{},M.local_yukatlura.settings={init:function(){if(e.DOM.byId("id_s_local_yukaltura_conn_server")){var t=e.one("#id_s_local_yukaltura_conn_server"),n=e.Node.getDOMNode(t);0==n.selectedIndex?e.DOM.byId("id_s_local_yukaltura_uri").disabled=!0:e.DOM.byId("id_s_local_yukaltura_uri").disabled=!1,t.on("change",function(t){t.preventDefault();var n=e.DOM.byId("id_s_local_yukaltura_uri");n.disabled?n.disabled=!1:n.disabled=!0});var r=e.one("#id_s_local_yukaltura_player"),i=e.Node.getDOMNode(r),s=i.length-1;s==i.selectedIndex?e.DOM.byId("id_s_local_yukaltura_player_custom").disabled=!1:e.DOM.byId("id_s_local_yukaltura_player_custom").disabled=!0,r.on("change",function(t){var n=e.DOM.byId("id_s_local_yukaltura_player_custom"),r=e.Node.getDOMNode(t.target),i=r.length-1;i==r.selectedIndex?n.disabled=!1:n.disabled=!0});var o=e.one("#id_s_local_yukaltura_player_resource"),u=e.Node.getDOMNode(o);s=u.length-1,s==u.selectedIndex?e.DOM.byId("id_s_local_yukaltura_player_resource_custom").disabled=!1:e.DOM.byId("id_s_local_yukaltura_player_resource_custom").disabled=!0,o.on("change",function(t){var n=e.DOM.byId("id_s_local_yukaltura_player_resource_custom"),r=e.Node.getDOMNode(t.target),i=r.length-1;i==r.selectedIndex?n.disabled=!1:n.disabled=!0})}},search_course:function(){YUI({filter:"raw"}).use("autocomplete",function(e){var t=e.one("#kaltura_search_txt"),n=document.getElementById("kaltura_search_txt"),r=e.one("#kaltura_search_btn"),i=e.one("#kaltura_clear_btn");t.plug(e.Plugin.AutoComplete,{resultTextLocator:"fullname",enableCache:!1,minQueryLength:2,resultListLocator:"data.courses",resultFormatter:function(t,n){return e.Array.map(n,function(e){var t=e.raw;return t.shortname?t.fullname+" ("+t.shortname+")":t.fullname})},source:"courses.php?query={query}&action=autocomplete",on:{select:function(t){t.preventDefault(),e.io("courses.php",{method:"POST",data:{course_id:t.result.raw.id,action:"select_course"},on:{success:function(t,n){var r=e.JSON.parse(n.responseText);r.failure&&r.failure==1?window.alert(r.message):document.getElementById("resourceobject").src=decodeURIComponent(r.url)}}})}}}),n.onkeypress=function(e){if(e.keyCode===13){var r=t.get("value");/^\s*$/.test(r)||(document.getElementById("resourceobject").src="courses.php?action=search&query="+r,n.blur())}},r.on("click",function(e){e.preventDefault();var r=t.get("value");/^\s*$/.test(r)||(document.getElementById("resourceobject").src="courses.php?action=search&query="+r,n.blur())}),i.on("click",function(e){e.preventDefault(),t.set("value","")})})},get_thumbnail_url:function(e){YUI().use("io-base","json-parse","node",function(t){function r(e,n){if(""!=n.responseText){var r=t.JSON.parse(n.responseText),i=t.one("#media_thumbnail");r.thumbnailUrl!=i.get("src")&&(i.set("src",r.thumbnailUrl),i.set("alt",r.name),i.set("title",r.name))}}var n=M.local_yukaltura.settings.dataroot+e;t.io(n),t.on("io:complete",r,t)})},loading_panel:{},show_loading:function(){M.local_yukaltura.settings.loading_panel=new e.YUI2.widget.Panel("wait",{width:"240px",fixedcenter:!0,close:!1,draggable:!1,zindex:4,modal:!0,visible:!1}),M.local_yukaltura.settings.loading_panel.setHeader("Loading, please wait..."),M.local_yukaltura.settings.loading_panel.setBody('<img src="../../local/yukaltura/pix/rel_interstitial_loading.gif" />'),M.local_yukaltura.settings.loading_panel.render(),M.local_yukaltura.settings.loading_panel.show()},hide_loading:function(){M.local_yukaltura.settings.loading_panel.hide()},dataroot:{},set_dataroot:function(e){M.local_yukaltura.settings.dataroot=e}}},"@VERSION@",{requires:["base","node","dom"]});
