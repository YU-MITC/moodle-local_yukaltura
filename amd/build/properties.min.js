/**
 * Media properties script for kaltura media embed.
 *
 * @copyright (C) 2016-2025 Yamaguchi University (gh-cc@mlex.cc.yamaguchi-u.ac.jp)
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_yukaltura/properties",["jquery"],(function($){return{init:function(propertiesUrl,invalidName,emptySize,invalidCustomSize,invalidSize){var modalX=0,modalY=0,timer=!1;function centeringModalSyncer(contentPanel){!1!==timer&&clearTimeout(timer),timer=setTimeout((function(){$(contentPanel).css({width:"550px",height:"400px"}),$(contentPanel).css({"font-size":"14px"});var w=$(window).width(),h=$(window).height(),cw=$(contentPanel).outerWidth(),ch=$(contentPanel).outerHeight();$(contentPanel).css({left:(w-cw)/2+"px",top:(h-ch)/2+"px"})}),200)}function checkPlayerDimension(width,height){return!(width<200||height<200)&&!(width>1280||height>1280)}function fadeOutPropertiesWindow(){window.scrollTo(modalX,modalY),$("#modal_window",parent.document).fadeOut("slow"),$("#modal_window",parent.document).remove(),$("#media_properties_panel",parent.document).fadeOut("slow"),$("#media_properties_panel",parent.document).remove()}function handlePlayerDimensionChange(){var flag=!1,widthStr=$("#media_prop_width").val(),heightStr=$("#media_prop_height").val(),regex=/^\d{2,4}$/;!0===regex.test(widthStr)&&!0===regex.test(heightStr)&&(flag=checkPlayerDimension(parseInt(widthStr),parseInt(heightStr)));!0===flag?($("#submit_btn").prop("disabled",!1),$("#submit_btn").css({opacity:"1.0"})):($("#submit_btn").prop("disabled",!0),$("#submit_btn").css({opacity:"0.5"}))}$("#id_media_properties").on("click",(function(){!function(url){if($(this).blur(),$("#modal_window")[0])return!1;var dElm=document.documentElement,dBody=document.body;modalX=dElm.scrollLeft||dBody.scrollLeft,modalY=dElm.scrollTop||dBody.scrollTop,$("body").append('<div id="media_properties_panel"></div>'),$("body").append('<div id="modal_window"></div>'),$("#modal_window").fadeIn("slow"),centeringModalSyncer("#media_properties_panel"),$("#media_properties_panel").fadeIn("slow"),$("#media_properties_panel").html('<iframe src="'+url+'" width="100%" height="100%">'),centeringModalSyncer("#media_properties_panel"),$(parent.window).resize((function(){centeringModalSyncer("#media_properties_panel")}))}(propertiesUrl)})),$("#media_prop_size").on("change",(function(){$("#media_prop_size").prop("selectedIndex")==$("#media_prop_size").children("option").length-1?($("#media_prop_width").prop("disabled",!1),$("#media_prop_height").prop("disabled",!1),$("#submit_btn").prop("disabled",!0),$("#submit_btn").css({opacity:"0.5"})):($("#media_prop_width").val(""),$("#media_prop_height").val(""),$("#media_prop_width").prop("disabled",!0),$("#media_prop_height").prop("disabled",!0),$("#submit_btn").prop("disabled",!1),$("#submit_btn").css({opacity:"1.0"}))})),$("#media_prop_width").on("change",(function(){handlePlayerDimensionChange()})),$("#media_prop_height").on("change",(function(){handlePlayerDimensionChange()})),$("#submit_btn").on("click",(function(){!function(){var str=$("#media_prop_name").val();if(!1===function(str){return!0!==/["$%&'~^\\`/]/.test(str)}(str=str.trim()))return window.alert(invalidName),!1;var width="",height="";if($("#media_prop_size").prop("selectedIndex")==$("#media_prop_size").children("option").length-1){if(""===$("#media_prop_width").value||""===$("#media_prop_height").value)return window.alert(emptySize),!1;width=$("#media_prop_width").val(),height=$("#media_prop_height").val(),width=width.trim(),height=height.trim();var regex=/^\d{2,4}$/;if(!1===regex.test(width)||!1===regex.test(height))return window.alert(invalidCustomSize),!1}else{var dimensionArray=$("#media_prop_size option:selected").text().match(/\d{2,4}/g);if(null===dimensionArray||2!=dimensionArray.length)return window.alert(invalidSize),!1;width=dimensionArray[0],height=dimensionArray[1]}!1===checkPlayerDimension(parseInt(width),parseInt(height))?window.alert(invalidSize):($("#width",parent.document).val(width),$("#height",parent.document).val(height),$("media_title",parent.document).val(str),$("#uiconf_id",parent.document).val($("#media_prop_player").val()),fadeOutPropertiesWindow())}()})),$("#cancel_btn").on("click",(function(){fadeOutPropertiesWindow()})),-1!=$(location).attr("pathname").indexOf("media_properties.php")&&function(){$("#media_prop_name").val($("#media_title",parent.document).val());for(var uiconfid=$("#uiconf_id",parent.document).val(),flag=!1,i=0;i<$("#media_prop_player").children("option").length;i++)$("#media_prop_player option:eq("+i+")").val()==uiconfid&&($("#media_prop_player").prop("selectedIndex",i),flag=!0);!1===flag&&$("#media_prop_player").prop("selectedIndex",0);var width=$("#width",parent.document).val(),height=$("#height",parent.document).val(),dimension=width+"x"+height;if($("#media_prop_width").prop("disabled",!1),$("#media_prop_height").prop("disabled",!1),""!==width&&"0"!=width&&""!==height&&"0"!=height){for(var j=0;j<$("#media_prop_size").children("option").length;j++)-1!=$("#media_prop_size option:eq("+j+")").text().indexOf(dimension)&&($("#media_prop_size").prop("selectedIndex",j),$("#media_prop_width").prop("disabled",!0),$("#media_prop_height").prop("disabled",!0));if(!1===$("#media_prop_width").prop("disabled")){var index=$("#media_prop_size").children("option").length-1;$("#media_prop_size").prop("selectedIndex",index),$("#media_prop_width").val(width),$("#media_prop_height").val(height)}}else $("#media_prop_width").val(""),$("#media_prop_height").val(""),$("#media_prop_size").prop("selectedIndex",0)}()}}}));

//# sourceMappingURL=properties.min.js.map