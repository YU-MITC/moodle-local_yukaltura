define(["jquery"],function(a){return{init:function(b,c,d,e,f){function g(b){r!==!1&&clearTimeout(r),r=setTimeout(function(){a(b).css({width:"400px",height:"400px"}),a(b).css({"font-size":"14px"});var c=a(window).width(),d=a(window).height(),e=a(b).outerWidth(),f=a(b).outerHeight();a(b).css({left:(c-e)/2+"px",top:(d-f)/2+"px"})},200)}function h(a){var b=/["$%&'~\^\\`\/]/;return b.test(a)===!0?!1:!0}function i(a,b){return 200>a||200>b?!1:a>1280||b>1280?!1:!0}function j(b){if(a(this).blur(),a("#modal_window")[0])return!1;var c=document.documentElement,d=document.body;return p=c.scrollLeft||d.scrollLeft,q=c.scrollTop||d.scrollTop,a("body").append('<div id="media_properties_panel"></div>'),a("body").append('<div id="modal_window"></div>'),a("#modal_window").fadeIn("slow"),g("#media_properties_panel"),a("#media_properties_panel").fadeIn("slow"),a("#media_properties_panel").html('<iframe src="'+b+'" width="100%" height="100%">'),g("#media_properties_panel"),a(parent.window).resize(function(){g("#media_properties_panel")}),!0}function k(){window.scrollTo(p,q),a("#modal_window",parent.document).fadeOut("slow"),a("#modal_window",parent.document).remove(),a("#media_properties_panel",parent.document).fadeOut("slow"),a("#media_properties_panel",parent.document).remove()}function l(){var b=!1,c=a("#media_prop_width").val(),d=a("#media_prop_height").val(),e=/^\d{2,4}$/;if(e.test(c)===!0&&e.test(d)===!0){var f=parseInt(c),g=parseInt(d);b=i(f,g)}b===!0?(a("#submit_btn").prop("disabled",!1),a("#submit_btn").css({opacity:"1.0"})):(a("#submit_btn").prop("disabled",!0),a("#submit_btn").css({opacity:"0.5"}))}function m(){var b=a("#media_prop_size").prop("selectedIndex");b==a("#media_prop_size").children("option").length-1?(a("#media_prop_width").prop("disabled",!1),a("#media_prop_height").prop("disabled",!1),a("#submit_btn").prop("disabled",!0),a("#submit_btn").css({opacity:"0.5"})):(a("#media_prop_width").val(""),a("#media_prop_height").val(""),a("#media_prop_width").prop("disabled",!0),a("#media_prop_height").prop("disabled",!0),a("#submit_btn").prop("disabled",!1),a("#submit_btn").css({opacity:"1.0"}))}function n(){var b=a("#media_prop_name").val();if(b=b.trim(),h(b)===!1)return window.alert(c),!1;var g=a("#media_prop_size").prop("selectedIndex"),j="",l="";if(g==a("#media_prop_size").children("option").length-1){if(""===a("#media_prop_width").value||""===a("#media_prop_height").value)return window.alert(d),!1;j=a("#media_prop_width").val(),l=a("#media_prop_height").val(),j=j.trim(),l=l.trim();var m=/^\d{2,4}$/;if(m.test(j)===!1||m.test(l)===!1)return window.alert(e),!1}else{var n=a("#media_prop_size option:selected").text(),o=n.match(/\d{2,4}/g);if(null===o||2!=o.length)return window.alert(f),!1;j=o[0],l=o[1]}return i(parseInt(j),parseInt(l))===!1?(window.alert(f),!1):(a("#width",parent.document).val(j),a("#height",parent.document).val(l),a("media_title",parent.document).val(b),a("#uiconf_id",parent.document).val(a("#media_prop_player").val()),k(),!0)}function o(){a("#media_prop_name").val(a("#media_title",parent.document).val());for(var b=a("#uiconf_id",parent.document).val(),c=!1,d=0;d<a("#media_prop_player").children("option").length;d++)a("#media_prop_player option:eq("+d+")").val()==b&&(a("#media_prop_player").prop("selectedIndex",d),c=!0);c===!1&&a("#media_prop_player").prop("selectedIndex",0);var e=a("#width",parent.document).val(),f=a("#height",parent.document).val(),g=e+"x"+f;if(a("#media_prop_width").prop("disabled",!1),a("#media_prop_height").prop("disabled",!1),""!==e&&"0"!=e&&""!==f&&"0"!=f){for(var h=0;h<a("#media_prop_size").children("option").length;h++)-1!=a("#media_prop_size option:eq("+h+")").text().indexOf(g)&&(a("#media_prop_size").prop("selectedIndex",h),a("#media_prop_width").prop("disabled",!0),a("#media_prop_height").prop("disabled",!0));if(a("#media_prop_width").prop("disabled")===!1){var i=a("#media_prop_size").children("option").length-1;a("#media_prop_size").prop("selectedIndex",i),a("#media_prop_width").val(e),a("#media_prop_height").val(f)}}else a("#media_prop_width").val(""),a("#media_prop_height").val(""),a("#media_prop_size").prop("selectedIndex",0)}var p=0,q=0,r=!1;a("#id_media_properties").on("click",function(){j(b)}),a("#media_prop_size").on("change",function(){m()}),a("#media_prop_width").on("change",function(){l()}),a("#media_prop_height").on("change",function(){l()}),a("#submit_btn").on("click",function(){n()}),a("#cancel_btn").on("click",function(){k()}),-1!=a(location).attr("pathname").indexOf("media_properties.php")&&o()}}});