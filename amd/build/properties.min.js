define(["jquery"],function(a){return{init:function(b){function c(b){n!==!1&&clearTimeout(n),n=setTimeout(function(){var c=a(window).width(),d=a(window).height(),e=a(b).outerWidth(),f=a(b).outerHeight();a(b).css({left:(c-e)/2+"px",top:(d-f)/2+"px"})},200)}function d(a){var b=/["$%&'~\^\\`\/]/;return b.test(a)===!0?!1:!0}function e(a,b){return 200>a||200>b?!1:a>1280||b>1280?!1:!0}function f(b){if(a(this).blur(),a("#modal_window")[0])return!1;var d=document.documentElement,e=document.body;l=d.scrollLeft||e.scrollLeft,m=d.scrollTop||e.scrollTop,a("body").append('<div id="media_properties_panel"></div>'),a("body").append('<div id="modal_window"></div>'),a("#modal_window").fadeIn("slow"),c("#media_properties_panel"),a("#media_properties_panel").fadeIn("slow"),a("#media_properties_panel").html('<iframe src="'+b+'" width="100%" height="100%">'),c("#media_properties_panel"),a(parent.window).resize(function(){c("#media_properties_panel")})}function g(){window.scrollTo(l,m),a("#modal_window",parent.document).fadeOut("slow"),a("#modal_window",parent.document).remove(),a("#media_properties_panel",parent.document).fadeOut("slow"),a("#media_properties_panel",parent.document).remove()}function h(){var b=!1,c=a("#media_prop_width").val(),d=a("#media_prop_height").val(),f=/^\d{2,4}$/;if(f.test(c)===!0&&f.test(d)===!0){var g=parseInt(c),h=parseInt(d);b=e(g,h)}b===!0?(a("#submit_btn").prop("disabled",!1),a("#submit_btn").css({opacity:"1.0"})):(a("#submit_btn").prop("disabled",!0),a("#submit_btn").css({opacity:"0.5"}))}function i(){var b=a("#media_prop_size").prop("selectedIndex");b==a("#media_prop_size").children("option").length-1?(a("#media_prop_width").prop("disabled",!1),a("#media_prop_height").prop("disabled",!1),a("#submit_btn").prop("disabled",!0),a("#submit_btn").css({opacity:"0.5"})):(a("#media_prop_width").val(""),a("#media_prop_height").val(""),a("#media_prop_width").prop("disabled",!0),a("#media_prop_height").prop("disabled",!0),a("#submit_btn").prop("disabled",!1),a("#submit_btn").css({opacity:"1.0"}))}function j(){var b=a("#media_prop_name").val();if(b=b.trim(),d(b)===!1)return window.alert("There is deprecated letter(s) in <Name>."),!1;var c=a("#media_prop_size").prop("selectedIndex"),f="",h="";if(c==a("#media_prop_size").children("option").length-1){if(""===a("#media_prop_width").value||""===a("#media_prop_height").value)return window.alert("Please input custom player size(width,height)."),!1;f=a("#media_prop_width").val(),h=a("#media_prop_height").val(),f=f.trim(),h=h.trim();var i=/^\d{2,4}$/;if(i.test(f)===!1||i.test(h)===!1)return window.alert("Custom player size(width,height) is a wrong dimension."),!1}else{var j=a("#media_prop_size option:selected").text();window.alert(j);var k=j.match(/\d{2,4}/g);if(null===k||2!=k.length)return window.alert("Player size(width,height) is a wrong dimension."),!1;f=k[0],h=k[1]}return e(parseInt(f),parseInt(h))===!1?(window.alert("Player size(width,height) is a wrong dimension."),!1):(a("#width",parent.document).val(f),a("#height",parent.document).val(h),a("media_title",parent.document).val(b),a("#uiconf_id",parent.document).val(a("#media_prop_player").val()),void g())}function k(){a("#media_prop_name").val(a("#media_title",parent.document).val());for(var b=a("#uiconf_id",parent.document).val(),c=!1,d=0;d<a("#media_prop_player").children("option").length;d++)a("#media_prop_player option:eq("+d+")").val()==b&&(a("#media_prop_player").prop("selectedIndex",d),c=!0);c===!1&&a("#media_prop_player").prop("selectedIndex",0);var e=a("#width",parent.document).val(),f=a("#height",parent.document).val(),g=e+"x"+f;if(a("#media_prop_width").prop("disabled",!1),a("#media_prop_height").prop("disabled",!1),""!==e&&"0"!=e&&""!==f&&"0"!=f){for(d=0;d<a("#media_prop_size").children("option").length;d++)-1!=a("#media_prop_size option:eq("+d+")").text().indexOf(g)&&(a("#media_prop_size").prop("selectedIndex",d),a("#media_prop_width").prop("disabled",!0),a("#media_prop_height").prop("disabled",!0));if(a("#media_prop_width").prop("disabled")===!1){var h=a("#media_prop_size").children("option").length-1;a("#media_prop_size").prop("selectedIndex",h),a("#media_prop_width").val(e),a("#media_prop_height").val(f)}}else a("#media_prop_width").val(""),a("#media_prop_height").val(""),a("#media_prop_size").prop("selectedIndex",0)}var l=0,m=0,n=!1;a("#id_media_properties").on("click",function(){f(b)}),a("#media_prop_size").on("change",function(){i()}),a("#media_prop_width").on("change",function(){h()}),a("#media_prop_height").on("change",function(){h()}),a("#submit_btn").on("click",function(){j()}),a("#cancel_btn").on("click",function(){g()}),-1!=a(location).attr("pathname").indexOf("media_properties.php")&&k()}}});